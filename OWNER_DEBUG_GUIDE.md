# 負責人問題診斷指南

## 問題描述
用戶輸入「銷售：成」，但系統顯示負責人為「客服003」而不是「成」。

## 診斷步驟

### 1. 重新提交資料
請在系統中提交以下測試資料：

```
客戶名稱：LILY C4639
聯繫電話：66615355
安裝時間：2025年11月27號下午2：30分
方案類型：全屋FH301+DC3000+T33+黑色原裝龍頭
總金額： 398*21+3=8361（享前3個月1蚊1個月優惠活動）
聯絡地址：氹仔路環金峰名匯第5座25b
備注：（LILY雙十一活動報裝享前3個月1蚊1個月優惠活動）舊客梁生65612288介紹安裝送2個月優惠。
銷售：成
客戶分類：家用客戶
目前付費方式：一次性全繳
使用方式：租
月費金額：398
按金：
預繳金：
```

### 2. 查看調試日誌

提交後，運行以下命令查看日誌：

```bash
cd "/Users/pureenergy/Documents/Codex/CRM系統程序/V8 查詢用戶指定資料 /一鍵新增客戶0501"
tail -50 server_app.log | grep -A 2 -B 2 "DEBUG"
```

### 3. 預期輸出

應該看到類似這樣的輸出：
```
[DEBUG] owner_hint = '成', in whitelist = True
```

或者：
```
[DEBUG] owner_hint = '', in whitelist = False
```

### 4. 可能的問題

#### 情況 A: owner_hint 為空
```
[DEBUG] owner_hint = '', in whitelist = False
```

**原因**：「銷售」字段沒有被正確解析為 `ownerHint`

**解決方案**：需要修改解析器，將「銷售」字段也映射到 `ownerHint`

#### 情況 B: owner_hint 有值但不在白名單
```
[DEBUG] owner_hint = '成', in whitelist = False
```

**原因**：白名單匹配失敗（可能是編碼問題）

**解決方案**：檢查白名單的字符編碼

#### 情況 C: owner_hint 正確且在白名單
```
[DEBUG] owner_hint = '成', in whitelist = True
```

**原因**：後續邏輯有問題，可能在其他地方被覆蓋

**解決方案**：檢查商機創建邏輯

## 下一步

請執行診斷步驟並告訴我調試日誌的輸出內容。
